<section class="body-full-color">
  <!-- <app-nav-bar></app-nav-bar> -->
  <div class="container overflow-x-auto mx-auto px-4 md:p-0 mt-10 md:mt-20">
      <table class="min-w-full w-full bg-white rounded-lg overflow-hidden">
          <thead class="bg-gray-800 text-white">
              <tr>
                  <th class="py-2 px-4">ID</th>
                  <th class="py-2 px-4">Username</th>
                  <th class="py-2 px-4">Email</th>
                  <th class="py-2 px-4">status</th>
                  <th class="py-2 px-4">Action</th>
              </tr>
          </thead>
          <tbody>
              <tr *ngFor="let user of users">
                  <td class="py-2 px-4 border border-gray-200">{{user.id}}</td>
                  <td [routerLink]="['/dashboard/user-profile/', user.id]" class="py-2 px-4 border text-blue cursor-pointer border-gray-200" >
                    <button mat-button color="accent" matTooltip="User details" (click)="openActivateModal(user.id)">
                      {{user.username}}
                    </button>
                  </td>
                  <td class="py-2 px-4 border border-gray-200">{{user.email}}</td>
                  <td class="py-2 px-4 border border-gray-200 text-center">
                    <button *ngIf="user.is_active" mat-button color="warn" matTooltip="Deactivate User" (click)="openDeactivateModal(user.id)">
                        deactivate
                      </button>
                      <button *ngIf="!user.is_active" mat-button color="accent" matTooltip="activate User" (click)="openActivateModal(user.id)">
                        activate
                      </button>
                  </td>
                  <td class="py-2 px-4 border border-gray-200 text-center">
                      <button [routerLink]="[ '/dashboard/user-datasets/', user.id ]" mat-button color="accent" matTooltip="User's datasets">
                        <span class="mdi mdi-source-repository-multiple"></span>
                      </button>
                      <button [routerLink]="[ '/dashboard/user-models/', user.id ]" mat-button color="accent" matTooltip="Users models" >
                        <span class="mdi mdi-brain"></span>
                      </button>
                      <button mat-button color="accent" (click)="openEditModal(user.id)" matTooltip="Edit User">
                        <span class="mdi mdi-account-edit"></span>                      
                    </button>
                      <button mat-button color="warn" (click)="openDeleteModal(user.id)" matTooltip="delete User">
                        <i class="fas fa-solid fa-trash"></i>                      
                    </button>
                  </td>
              </tr>
          </tbody>
      </table>
  </div>
</section>

<!-- Edit Modal -->


<!-- Delete Modal -->
<div *ngIf="isDeleteModalOpen" class="modal-overlay fixed inset-0 bg-black opacity-50 z-50"></div>
<div *ngIf="isDeleteModalOpen" class="modal-container fixed inset-0 flex items-center justify-center z-50">
  <div class="modal-content bg-white rounded-lg shadow-lg p-8">
      <h2 class="text-xl font-semibold mb-4">Confirm Deletion</h2>
      <p class="text-lg mb-4">Are you sure you want to delete this user?</p>
      <div class="flex justify-end">
        <button mat-button color="primary" (click)="closeModal()">Cancel</button>
        <button  mat-button color="warn" (click)="confirmDelete()">Confirm Delete</button>
    </div>
  </div>
</div>


<!-- Deactivate Modal -->
<div *ngIf="isDeactivateModalOpen" class="modal-overlay fixed inset-0 bg-black opacity-50 z-50"></div>
<div *ngIf="isDeactivateModalOpen" class="modal-container fixed inset-0 flex items-center justify-center z-50">
  <div class="modal-content bg-white rounded-lg shadow-lg p-8">
    <h2 class="text-xl font-semibold mb-4">Confirm Deactivation</h2>
    <p class="text-lg mb-4">Are you sure you want to Deactivate this user?</p>
    <div class="flex justify-end">
      <button mat-button color="primary" (click)="closeModal()">Cancel</button>
      <button mat-button color="accent" (click)="confirmDeactivate()">Confirm</button>
    </div>
</div>
</div>

<!-- Activate Modal -->
<div *ngIf="isActivateModalOpen" class="modal-overlay fixed inset-0 bg-black opacity-50 z-50"></div>
<div *ngIf="isActivateModalOpen" class="modal-container fixed inset-0 flex items-center justify-center z-50">
  <div class="modal-content bg-white rounded-lg shadow-lg p-8">
    <h2 class="text-xl font-semibold mb-4">Confirm Activation</h2>
    <p class="text-lg mb-4">Are you sure you want to Activate this user?</p>
    <div class="flex justify-end">
      <button mat-button color="primary" (click)="closeModal()">Cancel</button>
      <button mat-button color="accent" (click)="confirmActivate()">Confirm</button>
    </div>
</div>
</div>

<!-- Edit User Model -->
<div *ngIf="isEditModalOpen" class="modal-overlay fixed inset-0 bg-black opacity-50 z-50"></div>
<div *ngIf="isEditModalOpen" class="modal-container fixed inset-0 flex items-center justify-center z-50">
    <div class="modal-content bg-white rounded-lg shadow-lg p-8 w-full md:w-1/2 overflow-y-auto max-h-full">
        <h2 class="text-xl font-semibold mb-4">Edit User</h2>
        <form (submit)="ConfirmEditUser()">
          <div class="mb-4">
              <div class="inputs">               
                  <input required type="text" value="{{currentUser?.first_name}}" [ngModelOptions]="{standalone: true}" id="roleName" [(ngModel)]="first_name">
                  <label>First Name </label>
              </div>
          </div>
          <div class="mb-4">
              <div class="inputs">               
                  <input required type="text"  value="{{currentUser?.last_name}}" [ngModelOptions]="{standalone: true}" id="roleName" [(ngModel)]="last_name">
                  <label>Last Name </label>
              </div>
          </div>
            <div class="mb-4">
                <div class="inputs">               
                    <input required type="text" value="{{currentUser?.username}}" [ngModelOptions]="{standalone: true}" id="roleName" [(ngModel)]="username">
                    <label>User Name </label>
                </div>
            </div>
            <div class="mb-4">
                <div class="inputs">               
                    <input required type="email" value="{{currentUser?.email}}" [ngModelOptions]="{standalone: true}" id="roleName"  [(ngModel)]="email">
                    <label>Email </label>
                </div>
            </div>
            <div class="flex justify-end">
                <button type="submit" mat-button  (click)="ConfirmEditUser()" color="primary">Confirm Submit</button>
                <button mat-button color="accent" (click)="closeModal()">Close</button>
            </div>
        </form>
    </div>
</div>
